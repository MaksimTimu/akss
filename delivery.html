<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Доставка - Аксессуары ручной работы</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-inner">
                <a href="index.html" class="logo">
                    <img src="images/logo.png" alt="Логотип">
                </a>
                
                <nav class="nav">
                    <ul class="nav-list">
                        <li><a href="index.html">Главная</a></li>
                        <li><a href="catalog.html">Каталог</a></li>
                        <li><a href="about.html">О нас</a></li>
                        <li><a href="call.html">Позвонить нам</a></li>
                        <li><a href="delivery.html">Доставка</a></li>
                        <li><a href="account.html">Личный кабинет</a></li>
                        <li><a href="cart.html">Корзина</a></li>
                        <li><a href="admin.html">Админ панель</a></li>
                    </ul>
                </nav>
                
                <div class="burger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>

    <div class="mobile-menu">
        <ul class="mobile-nav">
            <li><a href="index.html">Главная</a></li>
            <li><a href="catalog.html">Каталог</a></li>
            <li><a href="about.html">О нас</a></li>
            <li><a href="call.html">Позвонить нам</a></li>
            <li><a href="delivery.html" class="active">Доставка</a></li>
            <li><a href="account.html">Личный кабинет</a></li>
            <li><a href="cart.html">Корзина</a></li>
            <li><a href="admin.html">Админ панель</a></li>
        </ul>
    </div>

    <main class="main">
        <div class="container">            
            <div class="delivery-container">
                <div class="delivery-form">
                    <h2>Форма оформления заказа</h2>
                    <form id="order-form">
                        <div class="form-group">
                            <label for="delivery-name">ФИО *</label>
                            <input type="text" id="delivery-name" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="delivery-phone">Телефон *</label>
                            <input type="tel" id="delivery-phone" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="delivery-email">Email *</label>
                            <input type="email" id="delivery-email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="delivery-address">Адрес доставки *</label>
                            <textarea id="delivery-address" rows="3" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="delivery-date">Дата доставки *</label>
                            <input type="date" id="delivery-date" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="delivery-time">Время доставки</label>
                            <select id="delivery-time">
                                <option value="9-12">9:00 - 12:00</option>
                                <option value="12-15">12:00 - 15:00</option>
                                <option value="15-18">15:00 - 18:00</option>
                                <option value="18-21">18:00 - 21:00</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="payment-method">Способ оплаты *</label>
                            <select id="payment-method" required>
                                <option value="card">Карта онлайн</option>
                                <option value="cash">Наличными при получении</option>
                                <option value="transfer">Банковский перевод</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="comments">Комментарий к заказу</label>
                            <textarea id="comments" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                
                <div class="order-summary">
                    <h2>Ваш заказ</h2>
                    <div id="order-items">
                        <!-- Товары из корзины будут загружены через JavaScript -->
                    </div>
                    
                    <div id="empty-order" class="empty-message" style="display: none;">
                        <i class="fas fa-shopping-cart fa-2x"></i>
                        <p>Ваша корзина пуста</p>
                    </div>
                    
                    <div class="order-total">
                        <div class="total-row">
                            <span>Товары:</span>
                            <span id="subtotal">0 ₽</span>
                        </div>
                        <div class="total-row">
                            <span>Доставка:</span>
                            <span id="delivery-cost">500 ₽</span>
                        </div>
                        <div class="total-row total">
                            <span>Итого:</span>
                            <span id="total-cost">500 ₽</span>
                        </div>
                    </div>
                    
                    <button id="place-order" class="btn btn-large">Оформить заказ</button>
                </div>
            </div>
            
            <div id="order-success" class="success-message" style="display: none;">
                <i class="fas fa-check-circle"></i>
                <p>Заказ успешно оформлен! Номер вашего заказа: <strong id="order-number"></strong></p>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>О нас</h3>
                    <p>Магазин аксессуаров ручной работы с 2010 года</p>
                </div>
                <div class="footer-section">
                    <h3>Контакты</h3>
                    <p>Email: info@accessories.ru</p>
                    <p>Телефон: +7 (999) 123-45-67</p>
                </div>
                <div class="footer-section">
                    <h3>Ссылки</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Главная</a></li>
                        <li><a href="catalog.html">Каталог</a></li>
                        <li><a href="about.html">О нас</a></li>
                        <li><a href="delivery.html">Доставка</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Аксессуары ручной работы. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Загрузка товаров из корзины
            function loadOrderItems() {
                const orderItemsContainer = document.getElementById('order-items');
                const emptyOrderMessage = document.getElementById('empty-order');
                const subtotalElement = document.getElementById('subtotal');
                const totalCostElement = document.getElementById('total-cost');
                const placeOrderBtn = document.getElementById('place-order');
                
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                
                if (cart.length === 0) {
                    orderItemsContainer.style.display = 'none';
                    emptyOrderMessage.style.display = 'block';
                    subtotalElement.textContent = '0 ₽';
                    totalCostElement.textContent = '500 ₽';
                    placeOrderBtn.disabled = true;
                    return;
                }
                
                orderItemsContainer.style.display = 'block';
                emptyOrderMessage.style.display = 'none';
                orderItemsContainer.innerHTML = '';
                
                let subtotal = 0;
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    subtotal += itemTotal;
                    
                    const itemElement = document.createElement('div');
                    itemElement.className = 'order-item';
                    itemElement.innerHTML = `
                        <span>${item.name} × ${item.quantity}</span>
                        <span>${itemTotal} ₽</span>
                    `;
                    orderItemsContainer.appendChild(itemElement);
                });
                
                const deliveryCost = 500;
                const total = subtotal + deliveryCost;
                
                subtotalElement.textContent = subtotal + ' ₽';
                totalCostElement.textContent = total + ' ₽';
                placeOrderBtn.disabled = false;
            }
            
            // Оформление заказа
            document.getElementById('place-order').addEventListener('click', function() {
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                
                if (cart.length === 0) {
                    alert('Корзина пуста!');
                    return;
                }
                
                // Проверяем заполнение обязательных полей
                const requiredFields = ['delivery-name', 'delivery-phone', 'delivery-email', 'delivery-address', 'delivery-date'];
                let isValid = true;
                
                requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        field.style.borderColor = 'red';
                        isValid = false;
                    } else {
                        field.style.borderColor = '#ddd';
                    }
                });
                
                if (!isValid) {
                    alert('Пожалуйста, заполните все обязательные поля (отмечены *)');
                    return;
                }
                
                // Создаем заказ
                const order = {
                    id: Date.now(),
                    date: new Date().toLocaleString('ru-RU'),
                    customer: {
                        name: document.getElementById('delivery-name').value,
                        phone: document.getElementById('delivery-phone').value,
                        email: document.getElementById('delivery-email').value,
                        address: document.getElementById('delivery-address').value,
                        deliveryDate: document.getElementById('delivery-date').value,
                        deliveryTime: document.getElementById('delivery-time').value,
                        paymentMethod: document.getElementById('payment-method').value,
                        comments: document.getElementById('comments').value
                    },
                    items: [...cart],
                    subtotal: calculateSubtotal(),
                    delivery: 500,
                    total: calculateSubtotal() + 500,
                    status: 'pending'
                };
                
                // Сохраняем заказ в историю
                let orders = JSON.parse(localStorage.getItem('orders') || '[]');
                orders.push(order);
                localStorage.setItem('orders', JSON.stringify(orders));
                
                // Очищаем корзину
                localStorage.removeItem('cart');
                
                // Показываем сообщение об успехе
                document.getElementById('order-number').textContent = '#' + order.id;
                document.getElementById('order-success').style.display = 'flex';
                
                // Очищаем форму
                document.getElementById('order-form').reset();
                
                // Обновляем отображение заказа
                loadOrderItems();
                
                // Скрываем сообщение через 5 секунд
                setTimeout(() => {
                    document.getElementById('order-success').style.display = 'none';
                }, 5000);
            });
            
            function calculateSubtotal() {
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            }
            
            // Устанавливаем минимальную дату доставки (завтра)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const minDate = tomorrow.toISOString().split('T')[0];
            document.getElementById('delivery-date').min = minDate;
            
            // Загружаем данные пользователя если есть
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            if (userData.name) {
                document.getElementById('delivery-name').value = userData.name;
                document.getElementById('delivery-email').value = userData.email;
                document.getElementById('delivery-phone').value = userData.phone || '';
                document.getElementById('delivery-address').value = userData.address || '';
            }
            
            // Загружаем корзину при загрузке страницы
            loadOrderItems();
        });
    </script>
</body>
</html>